import streamlit as st
import random

# é¡Œåº«ï¼ˆé¸æ“‡é¡Œï¼Œæ¯é¡ŒåŒ…å«å•é¡Œã€é¸é …èˆ‡æ­£ç¢ºç­”æ¡ˆï¼‰
question_pool = [
    {
        "question": "ã€Œé‡‘æ°ä¸–ç•Œç´€éŒ„ä¸­æœ€é‡çš„å—ç“œç‚º1,247å…¬æ–¤ï¼Œå¤§æ¦‚æ˜¯30ä½åœ‹å°ç”Ÿçš„é‡é‡ã€‚ã€ä»¥ä¸Šæè¿°å±¬æ–¼ä½•ç¨®è§£èªªæŠ€å·§ï¼Ÿ",
        "options": ["æå•æ³•", "æ¿ƒç¸®æ³•", "æ¼”ç®—æ³•", "å°æ¯”æ³•"],
        "answer": "å°æ¯”æ³•"
    },
    {
        "question": "ä¸‹åˆ—é‚£ç¨®è§£èªªå‘Šç¤ºç‰Œçš„èƒŒæ™¯é¡è‰²èˆ‡æ–‡å­—é¡è‰²æ­é…æœ€ä¸é©ç•¶ï¼Ÿ",
        "options": ["ç™½åº•é»‘å­—", "è—åº•ç™½å­—", "ç¶ åº•ç´…å­—", "é»ƒåº•é»‘å­—"],
        "answer": "ç¶ åº•ç´…å­—"
    },
    {
        "question": "ä¸‹åˆ—ä½•è€…ä¸æ˜¯é‡å°å¹´é•·éŠå®¢å°è¦½è§£èªªæ™‚é ˆæ³¨æ„çš„äº‹é …ï¼Ÿ",
        "options": ["ä»¥å®‰å…¨ç‚ºé¦–è¦æ¢ä»¶", "è§£èªªå…§å®¹å¤šèåˆå¹´é•·éŠå®¢çš„ç”Ÿæ´»ç¶“é©—", "è§£èªªæ™‚é ˆç•™æ„è¡Œé€²é€Ÿåº¦", "è€ƒé‡å¹´é•·è€…è¨˜æ€§å·®ï¼Œè§£èªªç‰‡æ®µå…§å®¹å³å¯"],
        "answer": "è€ƒé‡å¹´é•·è€…è¨˜æ€§å·®ï¼Œè§£èªªç‰‡æ®µå…§å®¹å³å¯"
    },
    {
        "question": "ç›¸è¼ƒæ–¼äººå“¡è§£èªªï¼Œã€Œéäººå“¡è§£èªªã€æ–¹å¼å…·æœ‰ä¸‹åˆ—ä½•ç¨®å„ªå‹¢ï¼Ÿ",
        "options": ["å¯ä»¥å³æ™‚æä¾›è§£èªªæœå‹™", "å®¹æ˜“è™•ç†ç·Šæ€¥ç‹€æ³", "èƒ½æ¿€ç™¼æ·±åº¦è¨è«–", "èƒ½æ ¹æ“šéŠå®¢ç‹€æ³èª¿æ•´è§£èªªå…§å®¹"],
        "answer": "å¯ä»¥å³æ™‚æä¾›è§£èªªæœå‹™"
    },
    {
        "question": "ä¸‹åˆ—æœ‰é—œè§£èªªçš„æè¿°ä½•è€…éŒ¯èª¤ï¼Ÿ",
        "options": ["è§£èªªæ–¹å¼å³èˆˆç™¼æ®å³å¯", "å°ˆæ¥­çŸ¥è­˜æ˜¯è§£èªªçš„åŸºç¤", "è§£èªªé‡é»åœ¨æ–¼å•Ÿç™¼å—çœ¾è€…", "è§£èªªéç¨‹æ‡‰å¾æ•´é«”é¢èªªæ˜"],
        "answer": "è§£èªªæ–¹å¼å³èˆˆç™¼æ®å³å¯"
    },
    {
        "question": "ä¸‹åˆ—ä½•ç¨®è§£èªªæ–¹å¼ä¸é©åˆé‹ç”¨åœ¨è¦åŠƒè‡ªå°å¼æ­¥é“è§£èªªï¼Ÿ",
        "options": ["è§£èªªæ‘ºé ", "è§£èªªç‰Œ", "éŒ„éŸ³è§£èªª", "å½±ç‰‡è§£èªª"],
        "answer": "å½±ç‰‡è§£èªª"
    },
    {
        "question": "ä¸€èˆ¬åœ¨æ—…éŠæ™¯é»è†è½å°è¦½è§£èªªçš„éŠå®¢å¤šæ˜¯æ‰€è¬‚çš„éå—åˆ¶è½çœ¾ï¼ˆNon-captive audiencesï¼‰ï¼Œæœ‰é—œéå—åˆ¶è½çœ¾çš„ç‰¹å¾µï¼Œä¸‹åˆ—æ•˜è¿°ä½•è€…éŒ¯èª¤ï¼Ÿ",
        "options": ["ä¸éœ€å°æ™‚é–“åšæ‰¿è«¾", "è‡ªé¡˜å‰ä¾†è†è½", "å¿…å®šå°ˆæ³¨å­¸ç¿’", "é¡å¤–çå‹µä¸é‡è¦"],
        "answer": "å¿…å®šå°ˆæ³¨å­¸ç¿’"
    }
]

# é é¢è¨­å®š
st.set_page_config(page_title="å³æ™‚æŠ½è€ƒæ¸¬é©—", layout="wide")
st.title("ğŸ¯ å³æ™‚æŠ½è€ƒï¼šé¸æ“‡é¡Œæ¸¬é©—")
st.write("æ¯æ¬¡éš¨æ©ŸæŠ½å‡º 5 é¡Œï¼Œä½œç­”å®Œç•¢å¾Œé»æ“Šä¸‹æ–¹ã€Œâœ… æäº¤ç­”æ¡ˆã€æŒ‰éˆ•é€²è¡Œè©•åˆ†ã€‚")

# åˆå§‹åŒ– session ç‹€æ…‹
if "quiz" not in st.session_state:
    st.session_state.quiz = random.sample(question_pool, 5)
    st.session_state.answers = {}

# é¡¯ç¤ºæ¯ä¸€é¡Œ
for i, q in enumerate(st.session_state.quiz):
    st.subheader(f"ç¬¬ {i+1} é¡Œ")
    st.write(q["question"])
    selected = st.radio(
        label="è«‹é¸æ“‡ä¸€å€‹ç­”æ¡ˆï¼š",
        options=q["options"],
        key=f"q{i}",
        index=-1  # é è¨­ä¸é¸
    )
    st.session_state.answers[i] = selected

# æäº¤ä¸¦è©•åˆ†
if st.button("âœ… æäº¤ç­”æ¡ˆä¸¦è©•åˆ†"):
    incomplete = any(ans == "" or ans is None for ans in st.session_state.answers.values())

    if incomplete:
        st.warning("âš ï¸ è«‹å®Œæˆæ‰€æœ‰é¡Œç›®å¾Œå†æäº¤ã€‚")
    else:
        score = 0
        st.subheader("ğŸ“ è©•åˆ†çµæœ")
        for i, q in enumerate(st.session_state.quiz):
            user_answer = st.session_state.answers[i].strip()
            correct = q["answer"].strip()
            if user_answer == correct:
                st.success(f"ç¬¬ {i+1} é¡Œï¼šç­”å°äº†ï¼âœ…ï¼ˆä½ çš„ç­”æ¡ˆï¼š{user_answer}ï¼‰")
                score += 1
            else:
                st.error(f"ç¬¬ {i+1} é¡Œï¼šç­”éŒ¯äº† âŒï¼ˆä½ çš„ç­”æ¡ˆï¼š{user_answer}ï¼Œæ­£ç¢ºç­”æ¡ˆï¼š{correct}ï¼‰")

        st.markdown(f"## ğŸ‰ ä½ çš„ç¸½åˆ†ï¼š{score} / 5")

        # æä¾›é‡æ–°æ¸¬é©—æŒ‰éˆ•
        if st.button("ğŸ”„ å†ä¾†ä¸€æ¬¡"):
            st.session_state.quiz = random.sample(question_pool, 5)
            st.session_state.answers = {}
            st.experimental_rerun()
